{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container">
  <h2>문서 작성</h2>

  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}

    <div>
      {{ form.title.label_tag }}
      {{ form.title }}
      {{ form.title.errors }}
    </div>

    <div>
      {{ form.content.label_tag }}
      {{ form.content }}
      {{ form.content.errors }}
    </div>

    <div>
      {{ form.consultants.label_tag }}
      {{ form.consultants }}
      {{ form.consultants.errors }}
    </div>

    <div>
      {{ form.approvers.label_tag }}
      {{ form.approvers }}
      {% if form.approvers.help_text %}
        <small class="muted">{{ form.approvers.help_text }}</small>
      {% endif %}
      {{ form.approvers.errors }}
    </div>

    <div>
      {{ form.receivers.label_tag }}
      {{ form.receivers }}
      {{ form.receivers.errors }}
    </div>

    <div>
      {{ form.files.label_tag }}
      {{ form.files }}
      {{ form.files.errors }}
    </div>

    <button type="submit">상신</button>
  </form>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {

  function enableToggle(selectId) {
    const sel = document.getElementById(selectId);
    if (!sel) return;

    sel.addEventListener("pointerdown", function (e) {
      const option = e.target;
      if (option.tagName !== "OPTION") return;

      e.preventDefault();
      option.selected = !option.selected;
      sel.dispatchEvent(new Event("change", { bubbles: true }));
    });
  }

  enableToggle("id_consultants");
  enableToggle("id_approvers");
  enableToggle("id_receivers");
});
</script>

{% endblock %}
